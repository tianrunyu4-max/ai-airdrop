# 充值系统配置指南

## 🎯 核心功能

用户通过USDT充值 → 管理员审核 → 自动到账30U（最低充值30U）

---

## 🔧 修改内容

### 1️⃣ **支持的链**

| 修改前 | 修改后 |
|--------|--------|
| TRC20（波场链）✅ | TRC20（波场链）✅ |
| ERC20（以太坊链）❌ | BEP20（币安智能链）✅ |

---

### 2️⃣ **充值配置**

```json
{
  "usdt_trc20": "你的TRC20地址",
  "usdt_bep20": "你的BEP20地址",
  "enable_recharge": true,
  "min_amount": 30,  // ✅ 最低充值30U
  "notice": "充值说明..."
}
```

---

## 📝 配置步骤

### **步骤1：准备充值地址**

准备好你的USDT收款地址：
- ✅ **TRC20地址**（波场链，手续费低）
- ✅ **BEP20地址**（币安智能链，手续费低）

> ⚠️ 确保地址正确，一旦配置错误，用户充值资金将无法找回！

---

### **步骤2：修改SQL配置**

1. 打开文件：`supabase/migrations/配置充值系统.sql`

2. 找到这两行：
```sql
'usdt_trc20', '请在这里填写你的TRC20地址',
'usdt_bep20', '请在这里填写你的BEP20地址',
```

3. 替换为你的真实地址：
```sql
'usdt_trc20', 'TXyz123abcYourRealTRC20Address',
'usdt_bep20', '0xabc456YourRealBEP20Address',
```

---

### **步骤3：执行SQL**

1. 登录 Supabase Dashboard
2. 进入 SQL Editor
3. 复制整个 `配置充值系统.sql` 文件内容
4. 粘贴并执行

---

## 🎬 充值流程

### **用户端：**

```
1. 打开"我的"页面 → 点击"💰 充值"
2. 选择网络（TRC20 或 BEP20）
3. 复制充值地址
4. 在钱包转账（最低30 USDT）
5. 填写充值金额和交易哈希
6. 提交申请
```

### **管理员端：**

```
1. 登录管理后台
2. 进入"充值审核"页面
3. 查看待审核充值申请
4. 验证交易哈希（可选）
5. 点击"✅ 确认充值"
   → 用户账户自动到账30U（或实际充值金额）
```

---

## 📊 充值页面展示

### **用户充值界面**

```
┌─────────────────────────────────────┐
│        💰 USDT充值                   │
├─────────────────────────────────────┤
│                                     │
│  选择网络：                          │
│  ┌───────┐  ┌───────┐               │
│  │ TRC20 │  │ BEP20 │               │
│  └───────┘  └───────┘               │
│                                     │
│  转账至此地址：                       │
│  ┌─────────────────────────────┐   │
│  │ TXyz123abc...               │   │
│  └─────────────────────────────┘   │
│  📋 复制地址                        │
│                                     │
│  充值金额 (USDT)：                   │
│  ┌─────────────────────────────┐   │
│  │ 最低充值 30 USDT             │   │
│  └─────────────────────────────┘   │
│                                     │
│  交易哈希 (可选)：                   │
│  ┌─────────────────────────────┐   │
│  │ 粘贴交易哈希以便快速确认...   │   │
│  └─────────────────────────────┘   │
│                                     │
│     ✅ 提交充值                      │
└─────────────────────────────────────┘
```

---

## ⚠️ 重要提示

### **安全提醒**

1. ✅ **确保地址正确**：TRC20和BEP20是不同的链，地址格式不同
   - TRC20：以 `T` 开头
   - BEP20：以 `0x` 开头

2. ✅ **测试充值**：配置后先用小额测试（30U）

3. ✅ **备份地址**：记录配置的充值地址，以便后续核对

### **用户须知**

1. ❌ **跨链转账**：不要从TRC20转到BEP20地址（反之亦然）
2. ⏰ **到账时间**：管理员审核后即时到账
3. 💰 **最低金额**：30 USDT起充

---

## 🔑 核心代码修改

### **1. 接口定义**：`src/services/RechargeService.ts`

```typescript
export interface RechargeConfig {
  usdt_trc20: string      // ✅ TRC20地址
  usdt_bep20: string      // ✅ BEP20地址（原ERC20）
  enable_recharge: boolean
  min_amount: number      // ✅ 最低充值30U
  notice: string
}
```

### **2. 前端页面**：`src/views/profile/ProfileView.vue`

```vue
<!-- 选择网络 -->
<button @click="rechargeData.network = 'TRC20'">TRC20</button>
<button @click="rechargeData.network = 'BEP20'">BEP20</button> ✅

<!-- 显示地址 -->
{{ rechargeData.network === 'TRC20' 
   ? rechargeConfig.usdt_trc20 
   : rechargeConfig.usdt_bep20 }} ✅
```

### **3. 数据库配置**：`supabase/migrations/配置充值系统.sql`

```sql
INSERT INTO system_config (key, value)
VALUES (
  'recharge_config',
  jsonb_build_object(
    'usdt_trc20', '你的TRC20地址',
    'usdt_bep20', '你的BEP20地址',
    'min_amount', 30  -- ✅ 最低30U
  )
);
```

---

## 📋 测试清单

配置完成后，请按以下步骤测试：

- [ ] 1. 打开前端页面，进入"我的" → "充值"
- [ ] 2. 选择TRC20，检查显示的地址是否正确
- [ ] 3. 选择BEP20，检查显示的地址是否正确
- [ ] 4. 尝试输入29U，检查是否提示"最低充值30U"
- [ ] 5. 输入30U，填写测试交易哈希，提交申请
- [ ] 6. 管理员审核通过后，检查用户余额是否增加

---

## 🚀 部署状态

**代码修改：**
- ✅ `src/services/RechargeService.ts` - 接口定义
- ✅ `src/views/profile/ProfileView.vue` - 前端页面
- ✅ `supabase/migrations/配置充值系统.sql` - 数据库配置

**待执行：**
1. ⏳ 在Supabase执行SQL配置
2. ⏳ 填写真实充值地址
3. ⏳ 测试充值流程

---

**配置时间：** 2025-10-25  
**最低充值：** 30 USDT  
**支持链：** TRC20（波场）+ BEP20（币安智能链）

