# è´­ä¹°é€»è¾‘ä¿®æ”¹æ€»ç»“

## ğŸ“ **ç”¨æˆ·éœ€æ±‚**
1. è´­ä¹°å­¦ä¹ æœºæ”¹ä¸ºä½¿ç”¨Uä½™é¢ï¼Œä¸å†ä½¿ç”¨ç§¯åˆ†
2. åº•éƒ¨æç¤ºæ–‡å­—æ”¹ä¸ºï¼š"æ’é˜Ÿé¢†å– å­¦ä¹ æœº æ¯•ä¸šäº†å¯ä»¥æŒç»­å­¦ä¹ é€ç§¯åˆ†"

---

## âœ… **å·²å®Œæˆçš„ä¿®æ”¹**

### **1. å‰ç«¯UIä¿®æ”¹ï¼ˆPointsView.vueï¼‰**

#### **è´­ä¹°åˆ¤æ–­é€»è¾‘ï¼š**
| ä¿®æ”¹é¡¹ | åŸé€»è¾‘ | æ–°é€»è¾‘ |
|--------|--------|--------|
| æ£€æŸ¥ä½™é¢ | æ£€æŸ¥`transfer_points`ï¼ˆäº’è½¬ç§¯åˆ†ï¼‰ | æ£€æŸ¥`u_balance`ï¼ˆUä½™é¢ï¼‰ |
| æˆæœ¬è®¡ç®— | `purchaseCount * 100`ç§¯åˆ† | `purchaseCount * 7`U |

**ä»£ç ï¼š**
```typescript
// æ˜¯å¦å¯ä»¥è´­ä¹°ï¼ˆä½¿ç”¨Uä½™é¢ï¼‰
const canPurchase = computed(() => {
  const totalCostU = purchaseCount.value * 7 // æ¯å°7U
  const uBalance = user.value?.u_balance || 0
  return uBalance >= totalCostU && myMachines.value.length + purchaseCount.value <= 10
})
```

#### **æ˜¾ç¤ºæ–‡å­—ä¿®æ”¹ï¼š**
| ä½ç½® | åŸæ–‡å­— | æ–°æ–‡å­— |
|------|--------|--------|
| æˆæœ¬æ˜¾ç¤º | "æ€»æˆæœ¬ï¼šXXXç§¯åˆ† â‰ˆ XXXU" | "æ€»æˆæœ¬ï¼šXXXU" |
| æŒ‰é’®æ–‡å­—ï¼ˆä¸è¶³æ—¶ï¼‰ | "ç§¯åˆ†ä¸è¶³" | "Uä½™é¢ä¸è¶³" |
| é”™è¯¯æç¤º | "ç§¯åˆ†ä¸è¶³æˆ–è¶…å‡ºæ•°é‡é™åˆ¶" | "Uä½™é¢ä¸è¶³æˆ–è¶…å‡ºæ•°é‡é™åˆ¶" |
| ç¡®è®¤å¯¹è¯æ¡† | "æ€»æˆæœ¬ï¼šXXXç§¯åˆ†ï¼ˆXXXUï¼‰" | "æ€»æˆæœ¬ï¼šXXXU" |
| åº•éƒ¨æç¤º | "ğŸ ç¬¬ä¸€æ¬¡å…è´¹é€ Â· å‡ºå±€åå¯å¤è´­æˆ–æŒç»­å­¦ä¹  é€ç§¯åˆ†" | "ğŸ æ’é˜Ÿé¢†å– å­¦ä¹ æœº æ¯•ä¸šäº†å¯ä»¥æŒç»­å­¦ä¹ é€ç§¯åˆ†" |

---

### **2. åç«¯é€»è¾‘ä¿®æ”¹ï¼ˆMiningService.tsï¼‰**

#### **è´­ä¹°æ‰£æ¬¾é€»è¾‘ï¼š**
| ä¿®æ”¹é¡¹ | åŸé€»è¾‘ | æ–°é€»è¾‘ |
|--------|--------|--------|
| æ‰£æ¬¾æ–¹æ³• | `WalletManager.deductPoints()` | `WalletManager.deduct()` |
| æ‰£æ¬¾æ•°é‡ | 100ç§¯åˆ† | 7U |
| æµæ°´æè¿° | "è´­ä¹°å­¦ä¹ æœºï¼ˆ100ç§¯åˆ†=7Uï¼‰" | "è´­ä¹°å­¦ä¹ æœºï¼ˆ7Uï¼‰" |

**ä»£ç ï¼š**
```typescript
// 5. å¦‚æœä¸æ˜¯ç¬¬ä¸€æ¬¡ï¼Œæ‰£é™¤Uä½™é¢ï¼ˆä½¿ç”¨WalletManager - è‡ªåŠ¨éªŒè¯+æµæ°´ï¼‰
if (needsPayment) {
  await WalletManager.deduct(
    userId,
    MiningConfig.MACHINE.COST_IN_U, // 7U
    'mining_purchase',
    `è´­ä¹°${config.name}å­¦ä¹ æœºï¼ˆ7Uï¼‰`
  )
}
```

---

## ğŸ“Š **ä¿®æ”¹å‰åå¯¹æ¯”**

### **ä¿®æ”¹å‰ï¼ˆä½¿ç”¨ç§¯åˆ†ï¼‰ï¼š**
```
è´­ä¹°æ¡ä»¶ï¼šäº’è½¬ç§¯åˆ† >= 100ç§¯åˆ†
æ˜¾ç¤ºï¼šæ€»æˆæœ¬ï¼š100ç§¯åˆ† â‰ˆ 7U
æŒ‰é’®ï¼šç§¯åˆ†ä¸è¶³
æ‰£æ¬¾ï¼šæ‰£é™¤100ç§¯åˆ†
```

### **ä¿®æ”¹åï¼ˆä½¿ç”¨Uï¼‰ï¼š**
```
è´­ä¹°æ¡ä»¶ï¼šUä½™é¢ >= 7U
æ˜¾ç¤ºï¼šæ€»æˆæœ¬ï¼š7U
æŒ‰é’®ï¼šUä½™é¢ä¸è¶³
æ‰£æ¬¾ï¼šæ‰£é™¤7U
```

---

## ğŸ”„ **æ•°æ®æµç¨‹**

### **è´­ä¹°æµç¨‹ï¼š**
1. **ç”¨æˆ·ç‚¹å‡»è´­ä¹°** â†’ æ£€æŸ¥Uä½™é¢æ˜¯å¦ >= 7U Ã— æ•°é‡
2. **ä½™é¢å……è¶³** â†’ ç¡®è®¤å¯¹è¯æ¡†æ˜¾ç¤ºï¼š"æ€»æˆæœ¬ï¼š7U"
3. **ç”¨æˆ·ç¡®è®¤** â†’ è°ƒç”¨åç«¯`MiningService.purchaseMachine`
4. **åç«¯å¤„ç†** â†’ `WalletManager.deduct(userId, 7, ...)`
5. **æ‰£é™¤æˆåŠŸ** â†’ åˆ›å»ºå­¦ä¹ æœºè®°å½•
6. **å‰ç«¯æ›´æ–°** â†’ é‡æ–°åŠ è½½å­¦ä¹ æœºåˆ—è¡¨å’Œç”¨æˆ·ä½™é¢

### **æ¶‰åŠçš„è¡¨å’Œå­—æ®µï¼š**
- **usersè¡¨**
  - `u_balance` - Uä½™é¢ï¼ˆæ‰£æ¬¾æ¥æºï¼‰ âœ…
  - `transfer_points` - äº’è½¬ç§¯åˆ†ï¼ˆä¸å†ä½¿ç”¨ï¼‰ âŒ
- **transactionsè¡¨**
  - è®°å½•è´­ä¹°æµæ°´ï¼ˆç±»å‹ï¼šmining_purchaseï¼‰
- **mining_machinesè¡¨**
  - åˆ›å»ºæ–°çš„å­¦ä¹ æœºè®°å½•

---

## âš ï¸ **é‡è¦æ³¨æ„äº‹é¡¹**

### **1. ç¬¬ä¸€æ¬¡è´­ä¹°ä»ç„¶å…è´¹**
- é€»è¾‘æœªæ”¹å˜ï¼šç¬¬ä¸€æ¬¡è´­ä¹°ä¸æ‰£æ¬¾
- ä»ç¬¬äºŒæ¬¡å¼€å§‹æ‰£é™¤7U

### **2. å¥–åŠ±é‚€è¯·äººçš„é€»è¾‘**
- è´­ä¹°æˆåŠŸåï¼Œé‚€è¯·äººä»ç„¶è·å¾—7Uå¥–åŠ±
- è¿™éƒ¨åˆ†é€»è¾‘æœªä¿®æ”¹

### **3. ä½™é¢ä¸è¶³å¤„ç†**
- å‰ç«¯ï¼šæç¤º"Uä½™é¢ä¸è¶³"
- åç«¯ï¼š`WalletManager.deduct`è‡ªåŠ¨æ£€æŸ¥ä½™é¢ï¼Œä¸è¶³æ—¶æŠ›å‡ºå¼‚å¸¸

### **4. æ•°æ®ä¸€è‡´æ€§**
- æ‰€æœ‰è´­ä¹°è®°å½•éƒ½ä¼šå†™å…¥`transactions`è¡¨
- ç±»å‹ä¸º`mining_purchase`
- æè¿°ä¸º"è´­ä¹°AIå­¦ä¹ æœºï¼ˆ7Uï¼‰"

---

## ğŸ¯ **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**

### **ä¿®æ”¹å‰çš„é—®é¢˜ï¼š**
- âŒ ç”¨æˆ·éœ€è¦å…ˆè·å¾—äº’è½¬ç§¯åˆ†æ‰èƒ½è´­ä¹°
- âŒ æ˜¾ç¤º"ç§¯åˆ†"å’Œ"U"ä¸¤ç§å•ä½ï¼Œå®¹æ˜“æ··æ·†
- âŒ æç¤ºæ–‡å­—ä¸å¤Ÿå‹å¥½

### **ä¿®æ”¹åçš„æ”¹è¿›ï¼š**
- âœ… ç›´æ¥ä½¿ç”¨Uè´­ä¹°ï¼Œé€»è¾‘æ¸…æ™°
- âœ… åªæ˜¾ç¤ºUï¼Œå•ä½ç»Ÿä¸€
- âœ… æç¤ºæ–‡å­—æ›´å‹å¥½ï¼š"æ’é˜Ÿé¢†å– å­¦ä¹ æœº æ¯•ä¸šäº†å¯ä»¥æŒç»­å­¦ä¹ é€ç§¯åˆ†"

---

## ğŸ“‚ **ä¿®æ”¹çš„æ–‡ä»¶æ¸…å•**

1. âœ… `src/views/points/PointsView.vue`
   - è´­ä¹°åˆ¤æ–­é€»è¾‘
   - UIæ˜¾ç¤ºæ–‡å­—
   - ç¡®è®¤å¯¹è¯æ¡†
   - åº•éƒ¨æç¤º

2. âœ… `src/services/MiningService.ts`
   - è´­ä¹°æ‰£æ¬¾é€»è¾‘
   - ä»`deductPoints`æ”¹ä¸º`deduct`
   - ä»æ‰£100ç§¯åˆ†æ”¹ä¸ºæ‰£7U

---

## ğŸš€ **æµ‹è¯•éªŒè¯**

### **éªŒè¯æ­¥éª¤ï¼š**
1. è®¿é—® `http://localhost:3003`
2. è¿›å…¥ **AIå­¦ä¹ æœº** é¡µé¢
3. æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š
   - âœ… æ˜¾ç¤º"æ€»æˆæœ¬ï¼š7U"ï¼ˆä¸æ˜¾ç¤ºç§¯åˆ†ï¼‰
   - âœ… Uä½™é¢ä¸è¶³æ—¶æ˜¾ç¤º"Uä½™é¢ä¸è¶³"
   - âœ… åº•éƒ¨æ˜¾ç¤º"ğŸ æ’é˜Ÿé¢†å– å­¦ä¹ æœº æ¯•ä¸šäº†å¯ä»¥æŒç»­å­¦ä¹ é€ç§¯åˆ†"
   - âœ… ç¡®è®¤å¯¹è¯æ¡†æ˜¾ç¤º"æ€»æˆæœ¬ï¼š7U"
   - âœ… è´­ä¹°æˆåŠŸåæ‰£é™¤7Uï¼ˆä¸æ‰£ç§¯åˆ†ï¼‰

### **é¢„æœŸç»“æœï¼š**
- Uä½™é¢ >= 7U â†’ å¯ä»¥è´­ä¹°
- Uä½™é¢ < 7U â†’ æŒ‰é’®ç°è‰²ï¼Œæ˜¾ç¤º"Uä½™é¢ä¸è¶³"
- è´­ä¹°æˆåŠŸ â†’ Uä½™é¢å‡å°‘7Uï¼Œè·å¾—1å°å­¦ä¹ æœº
- ç¬¬ä¸€æ¬¡è´­ä¹° â†’ å…è´¹è·å¾—å­¦ä¹ æœº

---

**ä¿®æ”¹å®Œæˆæ—¶é—´ï¼š** 2025-10-08
**å½±å“èŒƒå›´ï¼š** å‰ç«¯UI + åç«¯è´­ä¹°é€»è¾‘
**é£é™©ç­‰çº§ï¼š** ä¸­ï¼ˆæ¶‰åŠæ”¯ä»˜é€»è¾‘ï¼‰
**æµ‹è¯•çŠ¶æ€ï¼š** å¾…éªŒè¯

