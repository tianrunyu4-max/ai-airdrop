# âš™ï¸ **ç³»ç»Ÿå‚æ•°é…ç½®åŠŸèƒ½ - å®Œæ•´è¯´æ˜**

---

## ğŸ¯ **åŠŸèƒ½æ¦‚è¿°ï¼š**

**æ‰€æœ‰æ•°å­—å‚æ•°éƒ½å¯é…ç½®ï¼Œå®æ—¶ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯ï¼**

---

## ğŸ“‹ **å¯é…ç½®çš„å‚æ•°åˆ—è¡¨ï¼š**

### **1. Binaryå¯¹ç¢°ç³»ç»Ÿå‚æ•°**

| å‚æ•°é”® | é»˜è®¤å€¼ | å•ä½ | è¯´æ˜ | èŒƒå›´ |
|--------|--------|------|------|------|
| `agent_fee` | 30 | U | AIä»£ç†åŠ å…¥è´¹ç”¨ | 10-100 |
| `pairing_bonus_per_pair` | 7 | U | æ¯å¯¹å¯¹ç¢°å¥–é‡‘ | 1-20 |
| `level_bonus_per_person` | 2 | U | æ¯äººå¹³çº§å¥–é‡‘ | 0.5-10 |
| `reinvest_threshold` | 300 | U | åŸç‚¹å¤æŠ•é˜ˆå€¼ | 100-1000 |
| `max_free_pairings` | 10 | æ¬¡ | æœªè§£é”ç”¨æˆ·æœ€å¤šå¯¹ç¢°æ¬¡æ•° | 5-50 |
| `min_direct_referrals` | 2 | äºº | è§£é”æ— é™å¯¹ç¢°çš„æœ€å°‘ç›´æ¨äººæ•° | 1-10 |
| `level_bonus_depth` | 8 | ä»£ | å¹³çº§å¥–ä»£æ•° | 5-20 |
| `dividend_min_referrals` | 10 | äºº | åˆ†çº¢èµ„æ ¼çš„æœ€å°‘ç›´æ¨äººæ•° | 5-50 |
| `member_ratio` | 85 | % | ä¼šå‘˜è·å¾—å¯¹ç¢°å¥–çš„æ¯”ä¾‹ | 50-95 |
| `platform_ratio` | 15 | % | å¹³å°è´¹ç”¨æ¯”ä¾‹ï¼ˆè¿›å…¥åˆ†çº¢æ± ï¼‰ | 5-50 |

### **2. AIå­¦ä¹ æœºå‚æ•°**

| å‚æ•°é”® | é»˜è®¤å€¼ | å•ä½ | è¯´æ˜ | èŒƒå›´ |
|--------|--------|------|------|------|
| `machine_price` | 7 | U | å­¦ä¹ æœºä»·æ ¼ | 1-50 |
| `first_activation_points` | 100 | ç§¯åˆ† | é¦–æ¬¡æ¿€æ´»æ‰€éœ€ç§¯åˆ† | 50-500 |
| `daily_release_rate` | 10 | % | æ¯æ—¥é‡Šæ”¾ç‡ | 1-50 |
| `exit_multiplier` | 2 | å€ | é€€å‡ºå€æ•° | 1.5-5 |
| `to_u_percent` | 70 | % | é‡Šæ”¾åˆ°Uçš„æ¯”ä¾‹ | 50-100 |
| `to_transfer_percent` | 30 | % | é‡Šæ”¾åˆ°è½¬è´¦ç§¯åˆ†çš„æ¯”ä¾‹ | 0-50 |
| `max_machines_per_user` | 10 | å° | æ¯äººæœ€å¤šå­¦ä¹ æœºæ•°é‡ | 5-100 |

### **3. æç°å‚æ•°**

| å‚æ•°é”® | é»˜è®¤å€¼ | å•ä½ | è¯´æ˜ | èŒƒå›´ |
|--------|--------|------|------|------|
| `min_amount` | 10 | U | æœ€ä½æç°é‡‘é¢ | 1-100 |
| `fee_percent` | 5 | % | æç°æ‰‹ç»­è´¹æ¯”ä¾‹ | 0-20 |
| `daily_limit` | 10000 | U | æ¯æ—¥æç°é™é¢ | 1000-100000 |

---

## ğŸ—ï¸ **æŠ€æœ¯æ¶æ„ï¼š**

### **1. æ•°æ®åº“è¡¨**

```sql
CREATE TABLE system_params (
  id SERIAL PRIMARY KEY,
  category VARCHAR(50) NOT NULL,     -- åˆ†ç±»
  param_key VARCHAR(100) UNIQUE,     -- å‚æ•°é”®
  param_value DECIMAL(20,4),         -- å‚æ•°å€¼
  param_unit VARCHAR(20),            -- å•ä½
  description TEXT,                  -- è¯´æ˜
  min_value DECIMAL(20,4),          -- æœ€å°å€¼
  max_value DECIMAL(20,4),          -- æœ€å¤§å€¼
  updated_at TIMESTAMP,             -- æ›´æ–°æ—¶é—´
  updated_by UUID                   -- æ›´æ–°äºº
);
```

### **2. åç«¯æœåŠ¡**

```typescript
// è¯»å–å‚æ•°ï¼ˆå¸¦ç¼“å­˜ï¼‰
const agentFee = await SystemParamsService.getParam('agent_fee')

// æ›´æ–°å‚æ•°
await SystemParamsService.updateParam('agent_fee', 50, adminId)

// æ‰¹é‡æ›´æ–°
await SystemParamsService.batchUpdateParams([
  { paramKey: 'agent_fee', newValue: 50 },
  { paramKey: 'pairing_bonus_per_pair', newValue: 10 }
], adminId)
```

### **3. å‰ç«¯ç®¡ç†ç•Œé¢**

```
è·¯å¾„ï¼š/admin/params

åŠŸèƒ½ï¼š
âœ… æŒ‰åˆ†ç±»æ˜¾ç¤ºæ‰€æœ‰å‚æ•°
âœ… å®æ—¶è¾“å…¥éªŒè¯ï¼ˆèŒƒå›´æ£€æŸ¥ï¼‰
âœ… æ‰¹é‡ä¿å­˜
âœ… æ’¤é”€æ›´æ”¹
âœ… æ˜¾ç¤ºæ›´æ”¹çŠ¶æ€
```

---

## ğŸ”§ **ä½¿ç”¨æ–¹æ³•ï¼š**

### **ç®¡ç†å‘˜ä¿®æ”¹å‚æ•°**

1. ç™»å½•ç®¡ç†åå°
2. ç‚¹å‡»"ç³»ç»Ÿå‚æ•°"èœå•
3. ä¿®æ”¹éœ€è¦çš„å‚æ•°å€¼
4. ç‚¹å‡»"ä¿å­˜æ‰€æœ‰æ›´æ”¹"
5. ç«‹å³ç”Ÿæ•ˆï¼ˆæ— éœ€é‡å¯ï¼‰

### **å¼€å‘è€…è¯»å–å‚æ•°**

```typescript
// åœ¨æœåŠ¡ä¸­è¯»å–å‚æ•°
import { SystemParamsService } from '@/services/SystemParamsService'

// è¯»å–å•ä¸ªå‚æ•°
const agentFee = await SystemParamsService.getParam('agent_fee')

// ä½¿ç”¨å‚æ•°
await WalletManager.deduct(userId, agentFee, 'agent_purchase', 'æˆä¸ºAIä»£ç†')
```

---

## âš¡ **ç¼“å­˜æœºåˆ¶ï¼š**

```typescript
ç¼“å­˜ç­–ç•¥ï¼š
- ç¼“å­˜æ—¶é—´ï¼š60ç§’
- è‡ªåŠ¨åˆ·æ–°ï¼šç¼“å­˜è¿‡æœŸåè‡ªåŠ¨é‡æ–°åŠ è½½
- æ‰‹åŠ¨åˆ·æ–°ï¼šæ›´æ–°å‚æ•°åè‡ªåŠ¨æ¸…é™¤ç¼“å­˜

æ€§èƒ½ä¼˜åŒ–ï¼š
- é¦–æ¬¡æŸ¥è¯¢ï¼šä»æ•°æ®åº“è¯»å– â†’ å†™å…¥ç¼“å­˜
- åç»­æŸ¥è¯¢ï¼šç›´æ¥ä»ç¼“å­˜è¯»å–ï¼ˆ60ç§’å†…ï¼‰
- å‚æ•°æ›´æ–°ï¼šç«‹å³æ¸…é™¤ç¼“å­˜ â†’ ä¸‹æ¬¡æŸ¥è¯¢é‡æ–°åŠ è½½
```

---

## ğŸ”’ **å®‰å…¨æœºåˆ¶ï¼š**

### **1. æƒé™æ§åˆ¶**

```sql
-- RLSç­–ç•¥
- æ‰€æœ‰äººå¯ä»¥è¯»å–å‚æ•°
- åªæœ‰ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹å‚æ•°
```

### **2. èŒƒå›´éªŒè¯**

```typescript
// å‰ç«¯éªŒè¯ï¼ˆå®æ—¶ï¼‰
<input 
  :min="param.min_value" 
  :max="param.max_value"
/>

// åç«¯éªŒè¯ï¼ˆä¿å­˜æ—¶ï¼‰
if (newValue < minValue || newValue > maxValue) {
  throw new Error('å‚æ•°å€¼è¶…å‡ºå…è®¸èŒƒå›´')
}
```

### **3. å®¡è®¡æ—¥å¿—**

```typescript
// è®°å½•æ‰€æœ‰å‚æ•°å˜æ›´
updated_at: æ›´æ–°æ—¶é—´
updated_by: æ›´æ–°äººID
```

---

## ğŸ“Š **æ•°æ®åº“è¿ç§»ï¼š**

### **æ‰§è¡ŒSQLï¼ˆåœ¨Supabaseï¼‰**

```sql
-- 1. åˆ›å»ºç³»ç»Ÿå‚æ•°è¡¨
-- æ–‡ä»¶ï¼šsupabase/migration_create_system_params.sql

-- 2. æ’å…¥é»˜è®¤å‚æ•°
-- è‡ªåŠ¨æ’å…¥æ‰€æœ‰é»˜è®¤å€¼

-- 3. æŸ¥çœ‹æ‰€æœ‰å‚æ•°
SELECT * FROM system_params ORDER BY category, param_key;
```

---

## ğŸ¨ **å‰ç«¯ç•Œé¢é¢„è§ˆï¼š**

```
âš™ï¸ ç³»ç»Ÿå‚æ•°é…ç½®
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[åˆ·æ–°æ•°æ®] [ğŸ’¾ ä¿å­˜æ‰€æœ‰æ›´æ”¹] [å–æ¶ˆæ›´æ”¹]

ğŸ”„ Binaryå¯¹ç¢°ç³»ç»Ÿå‚æ•°
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AIä»£ç†åŠ å…¥è´¹ç”¨                       â”‚
â”‚ [30] U     (10U - 100U)       [â†º]  â”‚
â”‚                                     â”‚
â”‚ æ¯å¯¹å¯¹ç¢°å¥–é‡‘                         â”‚
â”‚ [7] U      (1U - 20U)         [â†º]  â”‚
â”‚ ...                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ AIå­¦ä¹ æœºå‚æ•°
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å­¦ä¹ æœºä»·æ ¼                           â”‚
â”‚ [7] U      (1U - 50U)         [â†º]  â”‚
â”‚ ...                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… **å·²å®ŒæˆåŠŸèƒ½ï¼š**

```
âœ… æ•°æ®åº“è¡¨åˆ›å»º
âœ… SystemParamsServiceï¼ˆè¯»å–/æ›´æ–°ï¼‰
âœ… ç¼“å­˜æœºåˆ¶ï¼ˆ60ç§’TTLï¼‰
âœ… å‰ç«¯ç®¡ç†ç•Œé¢
âœ… ParamInputç»„ä»¶ï¼ˆè¾“å…¥éªŒè¯ï¼‰
âœ… è·¯ç”±é…ç½®
âœ… ç®¡ç†åå°å¯¼èˆª
âœ… RLSæƒé™æ§åˆ¶
âœ… èŒƒå›´éªŒè¯
âœ… æ‰¹é‡ä¿å­˜
âœ… æ’¤é”€æ›´æ”¹
```

---

## ğŸš€ **ä¸‹ä¸€æ­¥ï¼š**

### **ä¿®æ”¹ç°æœ‰æœåŠ¡ä½¿ç”¨SystemParamsService**

éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ï¼š
1. `BinaryService.ts` - ä½¿ç”¨åŠ¨æ€å‚æ•°
2. `MiningService.ts` - ä½¿ç”¨åŠ¨æ€å‚æ•°
3. `AgentService.ts` - ä½¿ç”¨åŠ¨æ€å‚æ•°

ç¤ºä¾‹ï¼š
```typescript
// âŒ æ—§ä»£ç ï¼ˆç¡¬ç¼–ç ï¼‰
const AGENT_FEE = 30

// âœ… æ–°ä»£ç ï¼ˆåŠ¨æ€å‚æ•°ï¼‰
const agentFee = await SystemParamsService.getParam('agent_fee')
```

---

## ğŸ“ **æµ‹è¯•æ¸…å•ï¼š**

### **1. æ•°æ®åº“æµ‹è¯•**

```sql
-- æ‰§è¡Œè¿ç§»SQL
\i supabase/migration_create_system_params.sql

-- æŸ¥çœ‹å‚æ•°
SELECT * FROM system_params;

-- æµ‹è¯•æ›´æ–°
UPDATE system_params 
SET param_value = 50 
WHERE param_key = 'agent_fee';
```

### **2. å‰ç«¯æµ‹è¯•**

```
1. è®¿é—® /admin/params
2. ä¿®æ”¹ä»»æ„å‚æ•°
3. ç‚¹å‡»ä¿å­˜
4. åˆ·æ–°é¡µé¢ï¼ŒéªŒè¯å‚æ•°å·²ä¿å­˜
5. æµ‹è¯•æ’¤é”€æ›´æ”¹åŠŸèƒ½
6. æµ‹è¯•èŒƒå›´éªŒè¯ï¼ˆè¾“å…¥è¶…å‡ºèŒƒå›´çš„å€¼ï¼‰
```

### **3. åŠŸèƒ½æµ‹è¯•**

```
1. ä¿®æ”¹agent_feeä¸º50U
2. å°è¯•æˆä¸ºAIä»£ç†
3. éªŒè¯æ˜¯å¦æ‰£é™¤50Uï¼ˆè€Œä¸æ˜¯30Uï¼‰
4. ç¡®è®¤å‚æ•°å®æ—¶ç”Ÿæ•ˆ
```

---

## ğŸ‰ **å®Œæˆï¼**

**æ‰€æœ‰æ•°å­—å‚æ•°éƒ½å¯é…ç½®ï¼Œå®æ—¶ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯ï¼**

**ç®¡ç†å‘˜å¯ä»¥é€šè¿‡åå°è½»æ¾è°ƒæ•´æ‰€æœ‰ç³»ç»Ÿå‚æ•°ï¼** ğŸ’ª





































