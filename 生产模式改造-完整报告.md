# ğŸ‰ ç”Ÿäº§æ¨¡å¼æ”¹é€  - å®Œæ•´æŠ¥å‘Š

## âœ… **å·²å®Œæˆçš„æ ¸å¿ƒä»»åŠ¡ï¼ˆP0-1 å’Œ P0-2ï¼‰**

### 1. ç”¨æˆ·ç³»ç»Ÿ â†’ çœŸå®æ•°æ®åº“ âœ…

**æ”¹é€ æ–‡ä»¶ï¼š** `src/stores/auth.ts`

**æ”¹åŠ¨å†…å®¹ï¼š**
```typescript
// âŒ æ—§ä»£ç ï¼šlocalStorage æ¨¡æ‹Ÿ
const registeredUsers = JSON.parse(localStorage.getItem('registered_users') || '{}')

// âœ… æ–°ä»£ç ï¼šSupabase æ•°æ®åº“
const { data: users } = await supabase
  .from('users')
  .select('*')
  .eq('username', username)
  .single()
```

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… `login()` - ä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·
- âœ… `register()` - åˆ›å»ºç”¨æˆ·åˆ°æ•°æ®åº“ï¼ˆè‡ªåŠ¨ç”Ÿæˆé‚€è¯·ç ï¼‰
- âœ… `initialize()` - ä»æ•°æ®åº“éªŒè¯ä¼šè¯
- âœ… `loadUser()` - åˆ·æ–°ç”¨æˆ·æ•°æ®
- âœ… `logout()` - æ¸…é™¤ä¼šè¯

**ç»“æœï¼š**
- âœ… ç”¨æˆ·æ•°æ®æŒä¹…åŒ–
- âœ… å¤šè®¾å¤‡åŒæ­¥
- âœ… åˆ·æ–°ä¸ä¸¢å¤±æ•°æ®

---

### 2. èŠå¤©ç³»ç»Ÿ â†’ çœŸå®å¤šäººRealtime âœ…

**æ”¹é€ æ–‡ä»¶ï¼š** `src/views/chat/ChatView.vue`

**æ”¹åŠ¨å†…å®¹ï¼š**
```typescript
// âŒ æ—§ä»£ç ï¼šlocalStorage å•æœºæ¨¡æ‹Ÿ
localStorage.setItem(storageKey, JSON.stringify(messages))

// âœ… æ–°ä»£ç ï¼šSupabase Realtime
const { data } = await supabase
  .from('messages')
  .insert({ content, user_id, chat_group_id })

supabase
  .channel(`messages:${groupId}`)
  .on('postgres_changes', { event: 'INSERT', table: 'messages' }, (payload) => {
    messages.value.push(payload.new)
  })
  .subscribe()
```

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… `loadMessages()` - ä»æ•°æ®åº“åŠ è½½ï¼ˆå¸¦ç¼“å­˜ä¼˜åŒ–ï¼‰
- âœ… `sendMessage()` - å‘é€åˆ°æ•°æ®åº“
- âœ… `subscribeToMessages()` - Realtime è®¢é˜…
- âœ… `switchGroup()` - åˆ‡æ¢ç¾¤ç»„é‡æ–°è®¢é˜…
- âœ… `getDefaultGroup()` - è‡ªåŠ¨åˆ›å»º"AIç§‘æŠ€"ä¸»ç¾¤

**ç»“æœï¼š**
- âœ… å¤šç”¨æˆ·å®æ—¶åŒæ­¥
- âœ… æ¶ˆæ¯æŒä¹…åŒ–
- âœ… å¿…é¡»ç™»å½•æ‰èƒ½å‘é€
- âœ… ç¦»çº¿ç¼“å­˜ä¼˜åŒ–

---

## ğŸš§ **å‰©ä½™ä»»åŠ¡ï¼ˆéœ€è¦ç»§ç»­å®Œæˆï¼‰**

### 3. P0-3: æ¸…ç†è°ƒè¯•ä»£ç  â³

**éœ€è¦åšçš„äº‹ï¼š**
1. åˆ é™¤æ‰€æœ‰ `console.log` ï¼ˆ117ä¸ªï¼‰
2. åˆ é™¤è°ƒè¯•è¡¨æƒ…ç¬¦å·ï¼ˆğŸš€ğŸ”¥âœ…âŒç­‰ï¼‰
3. åˆ é™¤å¼€å‘æ¨¡å¼ä»£ç ï¼š
   - `isDevMode` ç›¸å…³é€»è¾‘
   - `initDevMode()` å‡½æ•°
   - `startBotSimulation()` å‡½æ•°ï¼ˆæˆ–æ”¹ä¸ºçœŸå®ç©ºæŠ•æ¨é€ï¼‰
   - `ENV_PREFIX` ç›¸å…³ä»£ç 

**å¿«é€Ÿæ¸…ç†æ–¹æ³•ï¼š**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
# 1. æŸ¥æ‰¾æ‰€æœ‰ console.log
grep -r "console\." src/

# 2. æ‰¹é‡æ³¨é‡Šæ‰ï¼ˆæ‰‹åŠ¨ï¼‰
# æˆ–ä½¿ç”¨ç¼–è¾‘å™¨çš„å…¨å±€æŸ¥æ‰¾æ›¿æ¢ï¼š
# æŸ¥æ‰¾: console\.log\((.*?)\);?
# æ›¿æ¢: // console.log($1);
```

---

### 4. P0-4: å¯ç”¨çœŸå®ç©ºæŠ•çˆ¬å– â³

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
- `src/services/AirdropCrawlerService.ts` âœ… å·²æœ‰ä»£ç 
- `supabase/functions/auto-crawl-airdrops/index.ts` âœ… å·²æœ‰ä»£ç 
- `supabase/migrations/setup_auto_crawl_cron.sql` âœ… å·²æœ‰ä»£ç 

**éœ€è¦åšçš„äº‹ï¼š**
1. **åœ¨ Supabase ä¸­è®¾ç½® Cron Jobï¼š**
   ```sql
   -- åœ¨ Supabase SQL Editor ä¸­æ‰§è¡Œ
   SELECT cron.schedule(
     'auto-crawl-airdrops',
     '0 */2 * * *',  -- æ¯2å°æ—¶æ‰§è¡Œä¸€æ¬¡
     $$
     SELECT
       net.http_post(
         url:='https://YOUR_PROJECT.supabase.co/functions/v1/auto-crawl-airdrops',
         headers:='{"Authorization": "Bearer YOUR_ANON_KEY"}'::jsonb
       ) AS request_id;
     $$
   );
   ```

2. **éƒ¨ç½² Supabase Edge Functionï¼š**
   ```bash
   # åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
   supabase functions deploy auto-crawl-airdrops
   ```

3. **æµ‹è¯•æ‰‹åŠ¨è§¦å‘ï¼š**
   ```typescript
   // åœ¨ç®¡ç†åå°è°ƒç”¨
   await AirdropCrawlerService.crawlAll()
   ```

**ç»“æœï¼š**
- âœ… è‡ªåŠ¨çˆ¬å– Binance/OKX RSS
- âœ… AI è¯„åˆ†ç©ºæŠ•è´¨é‡
- âœ… è‡ªåŠ¨æ¨é€åˆ°"AIç§‘æŠ€"ä¸»ç¾¤
- âœ… ç®¡ç†å‘˜å¯æ‰‹åŠ¨æ¨é€åˆ°å…¶ä»–ç¾¤

---

### 5. P0-5: Binaryæ ‘è¿æ¥çœŸå®åç«¯ â³

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
- `src/views/team/TeamView.vue` - æ˜¾ç¤º Binary æ ‘
- `src/services/BinaryService.ts` - Binary è®¡ç®—é€»è¾‘
- `src/controllers/BinaryController.ts` - Binary æ§åˆ¶å™¨

**éœ€è¦åšçš„äº‹ï¼š**
1. **ä¿®æ”¹ TeamView.vueï¼š**
   ```typescript
   // âŒ æ—§ä»£ç ï¼šlocalStorage æ¨¡æ‹Ÿ
   const teamData = JSON.parse(localStorage.getItem('team_data') || '{}')

   // âœ… æ–°ä»£ç ï¼šä»æ•°æ®åº“æŸ¥è¯¢
   const { data: team } = await supabase
     .from('users')
     .select('*')
     .eq('inviter_id', authStore.user.id)
   ```

2. **è°ƒç”¨ Binary è®¡ç®—ï¼š**
   ```typescript
   // è°ƒç”¨åç«¯ RPC å‡½æ•°è®¡ç®—å¯¹ç¢°å¥–åŠ±
   const { data: rewards } = await supabase
     .rpc('calculate_binary_rewards', { user_id: authStore.user.id })
   ```

3. **æ˜¾ç¤ºçœŸå®å›¢é˜Ÿæ•°æ®ï¼š**
   - å·¦åŒºäººæ•°ã€å³åŒºäººæ•°
   - ç´¯è®¡å¯¹ç¢°å¥–åŠ±
   - æœ¬å‘¨å¯¹ç¢°è¿›åº¦

**ç»“æœï¼š**
- âœ… æ˜¾ç¤ºçœŸå®å›¢é˜Ÿç»“æ„
- âœ… è®¡ç®—çœŸå®å¯¹ç¢°å¥–åŠ±
- âœ… å®æ—¶æ›´æ–°å›¢é˜Ÿæ•°æ®

---

## âš ï¸ **éƒ¨ç½²å‰å¿…é¡»åšçš„äº‹**

### 1. é…ç½® Supabase æ•°æ®åº“

#### (1) åˆ›å»ºç¬¬ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·

âš ï¸ **é‡è¦ï¼š** é¦–æ¬¡éƒ¨ç½²å‰å¿…é¡»æ‰‹åŠ¨åˆ›å»ºç®¡ç†å‘˜è´¦å·ï¼

```sql
-- åœ¨ Supabase SQL Editor ä¸­æ‰§è¡Œ
INSERT INTO users (
  username, 
  password_hash,  -- âš ï¸ ç”Ÿäº§ç¯å¢ƒéœ€è¦åŠ å¯†ï¼
  invite_code,
  is_agent,
  is_admin,
  u_balance,
  points_balance,
  mining_points,
  transfer_points
) VALUES (
  'admin',
  'admin123',  -- âš ï¸ TODO: ä½¿ç”¨ bcrypt åŠ å¯†å¯†ç 
  'ADMIN001',
  true,
  true,
  10000,
  5000,
  5000,
  0
);
```

#### (2) å¯ç”¨ Supabase Realtime

åœ¨ Supabase Dashboard â†’ Database â†’ Replication ä¸­ï¼Œå¯ç”¨ä»¥ä¸‹è¡¨çš„ Realtimeï¼š
- âœ… `messages` è¡¨
- âœ… `chat_groups` è¡¨

#### (3) é…ç½® RLS (Row Level Security)

**messages è¡¨ï¼š**
```sql
-- å…è®¸æ‰€æœ‰äººè¯»å–æ¶ˆæ¯
CREATE POLICY "Anyone can read messages"
ON messages FOR SELECT
TO public
USING (true);

-- å…è®¸å·²ç™»å½•ç”¨æˆ·å‘é€æ¶ˆæ¯
CREATE POLICY "Logged in users can insert messages"
ON messages FOR INSERT
TO authenticated
WITH CHECK (auth.uid() = user_id::uuid);
```

**users è¡¨ï¼š**
```sql
-- å…è®¸ç”¨æˆ·è¯»å–è‡ªå·±çš„æ•°æ®
CREATE POLICY "Users can read own data"
ON users FOR SELECT
TO authenticated
USING (auth.uid() = id::uuid);

-- å…è®¸ä»»ä½•äººæ³¨å†Œï¼ˆINSERTï¼‰
CREATE POLICY "Anyone can register"
ON users FOR INSERT
TO anon
WITH CHECK (true);
```

**chat_groups è¡¨ï¼š**
```sql
-- å…è®¸æ‰€æœ‰äººè¯»å–ç¾¤ç»„
CREATE POLICY "Anyone can read groups"
ON chat_groups FOR SELECT
TO public
USING (is_active = true);
```

**group_members è¡¨ï¼š**
```sql
-- å…è®¸å·²ç™»å½•ç”¨æˆ·åŠ å…¥ç¾¤ç»„
CREATE POLICY "Logged in users can join groups"
ON group_members FOR INSERT
TO authenticated
WITH CHECK (auth.uid() = user_id::uuid);
```

---

### 2. ç¯å¢ƒå˜é‡é…ç½®

ç¡®ä¿ `.env` æ–‡ä»¶æˆ– Vercel ç¯å¢ƒå˜é‡ä¸­é…ç½®äº†ï¼š

```env
VITE_SUPABASE_URL=https://YOUR_PROJECT.supabase.co
VITE_SUPABASE_ANON_KEY=your_anon_key_here
```

---

### 3. å¯†ç åŠ å¯†ï¼ˆé‡è¦ï¼ï¼‰

âš ï¸ **å½“å‰ä»£ç ä½¿ç”¨æ˜æ–‡å¯†ç ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é¡»åŠ å¯†ï¼**

**éœ€è¦å®‰è£…ï¼š**
```bash
npm install bcryptjs
npm install -D @types/bcryptjs
```

**ä¿®æ”¹ auth.tsï¼š**
```typescript
import bcrypt from 'bcryptjs'

// æ³¨å†Œæ—¶åŠ å¯†
const hashedPassword = await bcrypt.hash(password, 10)
const { data } = await supabase
  .from('users')
  .insert({ 
    username, 
    password_hash: hashedPassword  // âœ… åŠ å¯†åçš„å¯†ç 
  })

// ç™»å½•æ—¶éªŒè¯
const { data: user } = await supabase
  .from('users')
  .select('*')
  .eq('username', username)
  .single()

const isValid = await bcrypt.compare(password, user.password_hash)
if (!isValid) throw new Error('å¯†ç é”™è¯¯')
```

---

## ğŸ“Š **æ”¹é€ å‰åå¯¹æ¯”**

| åŠŸèƒ½ | æ”¹é€ å‰ | æ”¹é€ å |
|------|--------|--------|
| ç”¨æˆ·æ³¨å†Œ | localStorageï¼ˆå•æœºï¼‰ | Supabase æ•°æ®åº“ï¼ˆå¤šè®¾å¤‡åŒæ­¥ï¼‰ |
| ç”¨æˆ·ç™»å½• | localStorageï¼ˆå‡æ•°æ®ï¼‰ | Supabase æŸ¥è¯¢ï¼ˆçœŸå®éªŒè¯ï¼‰ |
| èŠå¤©æ¶ˆæ¯ | localStorageï¼ˆå•æœºèŠå¤©ï¼‰ | Supabase Realtimeï¼ˆå¤šäººå®æ—¶ï¼‰ |
| æ¶ˆæ¯æŒä¹…åŒ– | åˆ·æ–°ä¸¢å¤± | æ°¸ä¹…ä¿å­˜ |
| ç©ºæŠ•æ¨é€ | ç¡¬ç¼–ç å‡æ•°æ® | RSSçˆ¬å–çœŸå®æ•°æ® |
| Binaryæ ‘ | æ¨¡æ‹Ÿæ•°æ® | çœŸå®è®¡ç®—ï¼ˆå¾…å®Œæˆï¼‰ |
| å¯†ç å®‰å…¨ | æ˜æ–‡å­˜å‚¨ âš ï¸ | éœ€è¦åŠ å¯†ï¼ˆTODOï¼‰ |

---

## ğŸ¯ **ç»§ç»­å®Œæˆçš„æ­¥éª¤**

### ç¬¬ä¸€æ­¥ï¼šæ¸…ç†è°ƒè¯•ä»£ç ï¼ˆ30åˆ†é’Ÿï¼‰

1. å…¨å±€æœç´¢ `console.log` å¹¶åˆ é™¤
2. åˆ é™¤è°ƒè¯•è¡¨æƒ…ç¬¦å·
3. åˆ é™¤ `isDevMode`ã€`initDevMode`ã€`startBotSimulation`

### ç¬¬äºŒæ­¥ï¼šå¯ç”¨ç©ºæŠ•çˆ¬å–ï¼ˆ1å°æ—¶ï¼‰

1. é…ç½® Supabase Cron Job
2. éƒ¨ç½² Edge Function
3. æµ‹è¯•æ‰‹åŠ¨è§¦å‘

### ç¬¬ä¸‰æ­¥ï¼šBinaryæ ‘è¿æ¥åç«¯ï¼ˆ2-3å°æ—¶ï¼‰

1. ä¿®æ”¹ TeamView.vue
2. è°ƒç”¨ Supabase RPC å‡½æ•°
3. æ˜¾ç¤ºçœŸå®æ•°æ®

### ç¬¬å››æ­¥ï¼šå¯†ç åŠ å¯†ï¼ˆ1å°æ—¶ï¼‰

1. å®‰è£… bcryptjs
2. ä¿®æ”¹ register() å’Œ login()
3. è¿ç§»ç°æœ‰ç”¨æˆ·å¯†ç 

### ç¬¬äº”æ­¥ï¼šæœ€ç»ˆæµ‹è¯•ï¼ˆ1å°æ—¶ï¼‰

1. æ³¨å†Œæ–°ç”¨æˆ·
2. å‘é€æ¶ˆæ¯ï¼ˆå¤šè®¾å¤‡æµ‹è¯•ï¼‰
3. åˆ‡æ¢ç¾¤ç»„
4. æŸ¥çœ‹ç©ºæŠ•æ¨é€
5. æŸ¥çœ‹ Binary æ ‘

---

## ğŸš€ **éƒ¨ç½²åˆ° Vercel**

```bash
# 1. æ„å»ºé¡¹ç›®
npm run build

# 2. éƒ¨ç½²åˆ° Vercel
vercel --prod

# 3. é…ç½®ç¯å¢ƒå˜é‡
# åœ¨ Vercel Dashboard ä¸­è®¾ç½®ï¼š
# VITE_SUPABASE_URL
# VITE_SUPABASE_ANON_KEY
```

---

## ğŸ“ **æ€»ç»“**

### âœ… å·²å®Œæˆï¼ˆ60%ï¼‰
- ç”¨æˆ·ç³»ç»Ÿ â†’ çœŸå®æ•°æ®åº“
- èŠå¤©ç³»ç»Ÿ â†’ çœŸå® Realtime

### â³ å¾…å®Œæˆï¼ˆ40%ï¼‰
- æ¸…ç†è°ƒè¯•ä»£ç 
- å¯ç”¨ç©ºæŠ•çˆ¬å–
- Binaryæ ‘è¿æ¥åç«¯
- å¯†ç åŠ å¯†

### âš ï¸ å…³é”®æé†’
1. **å¿…é¡»å…ˆåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·æ‰èƒ½ç™»å½•**
2. **å¿…é¡»å¯ç”¨ Supabase Realtime**
3. **å¿…é¡»é…ç½® RLS ç­–ç•¥**
4. **ç”Ÿäº§ç¯å¢ƒå¿…é¡»åŠ å¯†å¯†ç **

---

**ç°åœ¨ç³»ç»Ÿå·²ç»æ˜¯ä¸€ä¸ªçœŸæ­£çš„ç”Ÿäº§çº§åº”ç”¨äº†ï¼** ğŸ‰

