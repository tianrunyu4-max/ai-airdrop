# 🔐 管理后台快速设置指南

## ✅ 管理后台已创建完成！

---

## 🎯 快速开始（3步）

### 第 1 步：运行数据库迁移

在 Supabase SQL Editor 中运行：

```sql
-- 方法1：如果是全新数据库，直接运行完整schema
-- 复制 supabase/schema.sql 的全部内容并运行

-- 方法2：如果已经运行过初始schema，只需运行迁移
-- 复制 supabase/migrations/001_add_admin_field.sql 的内容并运行
```

### 第 2 步：创建管理员账户

#### 方法A：设置现有用户为管理员

```sql
-- 将你的用户名设置为管理员
UPDATE users 
SET is_admin = TRUE 
WHERE username = 'your_username';  -- 替换为你的用户名
```

#### 方法B：在Supabase Dashboard中设置

1. 打开 Supabase → Table Editor → `users` 表
2. 找到你的用户记录
3. 编辑 `is_admin` 列，改为 `true`
4. 保存

### 第 3 步：访问管理后台

1. 使用管理员账户登录前端应用
2. 进入"我的"页面
3. 点击 **🔐 管理后台** 按钮（黄色按钮）
4. 或直接访问：`http://localhost:3000/admin`

---

## 📂 已创建的文件

### 前端组件
```
src/
├── layouts/
│   └── AdminLayout.vue                 ✅ 管理后台布局（侧边栏导航）
├── views/admin/
│   ├── DashboardView.vue              ✅ 仪表盘（数据统计）
│   ├── UsersView.vue                  ✅ 用户管理（搜索、调整余额）
│   ├── WithdrawalsView.vue            ✅ 提现审核（通过/拒绝）
│   ├── AirdropsView.vue               ✅ 空投管理（添加/编辑）
│   └── SystemView.vue                 ✅ 系统配置（参数设置、重启机制）
```

### 数据库迁移
```
supabase/
├── schema.sql                         ✅ 完整数据库Schema（已更新）
└── migrations/
    └── 001_add_admin_field.sql        ✅ 添加管理员字段的迁移脚本
```

### 文档
```
docs/
└── ADMIN_GUIDE.md                     ✅ 管理后台详细使用指南
```

---

## 🎨 管理后台功能

### 📊 仪表盘
- ✅ 总用户数 / 今日新增
- ✅ 代理用户数 / 付费率
- ✅ 待审核提现 / 金额
- ✅ 平台总收益 / 今日收益
- ✅ 最新用户列表
- ✅ 最新提现申请
- ✅ 快速操作按钮

### 👥 用户管理
- ✅ 用户列表（分页）
- ✅ 搜索（用户名/邀请码）
- ✅ 筛选（全部/代理/普通）
- ✅ 查看用户详情
- ✅ 调整余额（U余额/积分）
- ✅ 操作记录

### 💰 提现审核
- ✅ 提现申请列表
- ✅ 状态筛选
- ✅ 通过审核
- ✅ 拒绝审核（自动退款）
- ✅ 查看钱包地址
- ✅ 填写审核备注

### 🚀 空投管理
- ✅ 空投列表
- ✅ 手动添加空投
- ✅ 编辑空投信息
- ✅ 启用/停用空投
- ✅ AI评分管理

### ⚙️ 系统配置
- ✅ 修改系统参数（30U代理费、8U见点奖等）
- ✅ 矿机重启机制（危险操作）
- ✅ 实时生效

---

## 🔐 安全机制

### 权限控制
- ✅ 路由守卫（非管理员无法访问）
- ✅ Supabase RLS（行级安全）
- ✅ 管理员标识（is_admin 字段）

### 操作日志
- ✅ 管理员操作自动记录
- ✅ 包含操作时间、类型、目标
- ✅ 存储在 `admin_logs` 表

### 数据保护
- ✅ 敏感操作需要二次确认
- ✅ 重要操作需填写备注
- ✅ 不可逆操作有明确警告

---

## 📱 界面特性

### 响应式设计
- ✅ 桌面端：侧边栏导航
- ✅ 移动端：顶部栏 + 抽屉菜单
- ✅ 完美适配所有屏幕尺寸

### 用户体验
- ✅ 统一的DaisyUI主题
- ✅ 清晰的数据展示
- ✅ 直观的操作流程
- ✅ 实时数据刷新

---

## 🎯 使用示例

### 审核提现

```typescript
// 1. 进入"提现审核"页面
// 2. 看到待审核列表
// 3. 点击"通过"按钮
// 4. 填写备注（可选）
// 5. 确认
// 6. 系统更新状态为"已通过"
// 7. 手动转账给用户

// 或者拒绝：
// 3. 点击"拒绝"按钮
// 4. 填写拒绝原因（必填）
// 5. 确认
// 6. 系统自动退还用户余额
```

### 调整用户余额

```typescript
// 1. 进入"用户管理"页面
// 2. 搜索用户
// 3. 点击"调整余额"
// 4. 选择类型（U余额/积分）
// 5. 输入金额（+10 增加，-10 减少）
// 6. 填写备注原因
// 7. 确认
// 8. 系统更新余额并记录交易
```

### 修改系统参数

```typescript
// 1. 进入"系统配置"页面
// 2. 修改参数（如代理费从30U改为25U）
// 3. 点击"保存配置"
// 4. 立即生效
```

---

## 📊 数据库表说明

### users 表（新增字段）
```sql
is_admin BOOLEAN DEFAULT FALSE  -- 是否为管理员
```

### admin_logs 表（新增）
```sql
-- 记录所有管理员操作
id UUID
admin_id UUID          -- 操作的管理员ID
action VARCHAR(50)     -- 操作类型（SELECT/UPDATE/DELETE等）
target_type VARCHAR(50) -- 目标表名
target_id UUID         -- 目标记录ID
details JSONB          -- 操作详情（包含旧值和新值）
created_at TIMESTAMP   -- 操作时间
```

---

## ⚡ 下一步开发建议

### 优先级1（1周内）
- [ ] 添加图表统计（使用Chart.js）
- [ ] 添加数据导出功能（Excel/CSV）
- [ ] 添加管理员操作日志查看页面
- [ ] 添加批量操作功能

### 优先级2（2-4周）
- [ ] 添加权限分级（超级管理员/普通管理员）
- [ ] 添加自动化报表
- [ ] 添加通知系统
- [ ] 添加数据备份功能

### 优先级3（1-2月）
- [ ] 添加风控系统（异常检测）
- [ ] 添加智能预警
- [ ] 添加API接口文档
- [ ] 开发移动端管理APP

---

## ❓ 常见问题

**Q: 管理后台入口在哪里？**  
A: 登录后进入"我的"页面，顶部会显示黄色的"🔐 管理后台"按钮（仅管理员可见）

**Q: 为什么看不到管理后台按钮？**  
A: 检查数据库中该用户的 `is_admin` 字段是否为 `true`

**Q: 如何添加更多管理员？**  
A: 在Supabase中将其他用户的 `is_admin` 字段改为 `true`

**Q: 管理后台支持移动端吗？**  
A: 支持！已做响应式适配，手机访问会显示移动端布局

**Q: 如何查看管理员操作日志？**  
A: 在Supabase中查询 `admin_logs` 表，或在管理后台添加日志查看页面

---

## 📚 相关文档

- [管理后台详细使用指南](docs/ADMIN_GUIDE.md)
- [开发指南](docs/DEVELOPMENT.md)
- [部署指南](docs/DEPLOYMENT.md)
- [项目总结](PROJECT_SUMMARY.md)

---

## ✅ 检查清单

完成以下检查确保管理后台正常工作：

- [ ] 运行数据库迁移脚本
- [ ] 创建至少一个管理员账户
- [ ] 登录并访问 `/admin`
- [ ] 查看仪表盘数据是否正常显示
- [ ] 测试用户管理功能
- [ ] 测试提现审核功能
- [ ] 测试系统配置修改
- [ ] 在移动端测试响应式布局

---

**🎉 恭喜！管理后台已经完全搭建好了！**

现在你可以：
1. ✅ 管理所有用户
2. ✅ 审核提现申请
3. ✅ 管理空投信息
4. ✅ 配置系统参数
5. ✅ 查看数据统计

有任何问题请查看 [ADMIN_GUIDE.md](docs/ADMIN_GUIDE.md) 或提交Issue！

© 2025 AI智能空投平台






