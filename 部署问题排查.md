# Vercel 部署问题排查

## ✅ 已确认正常
1. **本地构建成功** - `npm run build` 成功
2. **代码已推送** - GitHub仓库已更新（最新commit: d67d452）

---

## 🔍 可能的问题

### 1. Vercel 自动部署未触发
**原因**：
- Vercel webhook 未配置
- GitHub App 权限不足
- 分支设置不匹配（Vercel监听的分支不是main）

**解决方案**：
1. 登录 Vercel Dashboard
2. 进入项目设置 → Git → 检查监听的分支
3. 手动触发部署：Settings → Deployments → Redeploy

---

### 2. 构建命令或环境变量问题
**检查项**：
- Build Command: `npm run build` 或 `vite build`
- Output Directory: `dist`
- Install Command: `npm install`
- Node.js Version: 18.x 或 20.x

**Vercel 配置文件检查**：
检查 `netlify.toml` 是否存在（应该用 `vercel.json`）

---

### 3. 环境变量缺失
**需要的环境变量**：
```
VITE_SUPABASE_URL=你的Supabase URL
VITE_SUPABASE_ANON_KEY=你的Supabase Anon Key
```

**设置位置**：
Vercel Dashboard → Project → Settings → Environment Variables

---

## 🚀 立即解决方案

### 方案1：手动触发部署（最快）
1. 访问 Vercel Dashboard
2. 选择项目
3. 点击 "Deployments" 标签
4. 点击 "Redeploy" 按钮
5. 选择最新的 commit
6. 点击 "Deploy"

### 方案2：检查 Vercel 配置
创建 `vercel.json` 文件（如果不存在）：
```json
{
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "devCommand": "npm run dev",
  "installCommand": "npm install",
  "framework": "vite"
}
```

### 方案3：通过 Vercel CLI 部署
```bash
# 安装 Vercel CLI
npm i -g vercel

# 登录
vercel login

# 部署
vercel --prod
```

---

## 📱 测试步骤

部署成功后：
1. 访问 Vercel 提供的域名
2. 检查聊天页面是否正常显示
3. 测试发送消息功能
4. 检查双群分离功能

---

## ⚠️ 注意事项

1. **Netlify vs Vercel**：
   - 项目中有 `netlify.toml` 文件
   - 如果要用 Vercel，可以删除 `netlify.toml`
   - 或者继续用 Netlify 部署

2. **环境变量**：
   - 确保在 Vercel Dashboard 中设置了 Supabase 相关变量
   - 变量名必须以 `VITE_` 开头

3. **构建缓存**：
   - 如果部署失败，清除构建缓存再试
   - Vercel Dashboard → Settings → Clear Cache

---

## 🎯 推荐方案

**建议使用 Netlify 而非 Vercel**（项目已配置好）：

1. 访问 Netlify Dashboard
2. 连接 GitHub 仓库
3. 自动识别配置（已有 netlify.toml）
4. 点击部署

或者使用 Netlify CLI：
```bash
npm install -g netlify-cli
netlify login
netlify deploy --prod
```
